<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
			<!-- Leaflet styles and code. -->
	  	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
			<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>

			<!-- Turf code. -->
			<script src="https://npmcdn.com/@turf/turf/turf.min.js"></script>
	    <link rel="stylesheet" type="text/css" href="style.css">
	    <meta charset="utf-8" />

</head>
<body>
<div id="mapid" style="width: 600px; height: 600px;"></div>
<script src='data.js'></script>

  <script>
    var map = L.map('mapid',
                    {
      								center: [48.429380, -123.367070],
      								zoom: 13
    								}
              );

		var World_Light_Gray_Base = L.tileLayer(
      								'https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}',
                      { maxZoom: 17,

												attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
											}
										).addTo(map);

var facilities = {
										"type": "FeatureCollection" ,
										"crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:OGC:1.3:CRS84"}},
										"features":[{"type":"Feature","properties":{"Village_Ty":"Alix Goolden Performance Hall","Location":"Performance Space - Indoor Venue","OBJECTID_1":1},"geometry":{"type":"Point","coordinates":[-123.35835827377788,48.42726366320015]}},
										{"type":"Feature","properties":{"Village_Ty":"Belfry Theatre","Location":"Performance Space - Indoor Venue","OBJECTID_1":2},"geometry":{"type":"Point","coordinates":[-123.34576540224667,48.43012787973309]}},
										{"type":"Feature","properties":{"Village_Ty":"McPherson Playhouse","Location":"Performance Space - Indoor Venue","OBJECTID_1":3},"geometry":{"type":"Point","coordinates":[-123.3666832575059,48.42858066290988]}},
										{"type":"Feature","properties":{"Village_Ty":"Royal Theatre","Location":"Performance Space - Indoor Venue","OBJECTID_1":4},"geometry":{"type":"Point","coordinates":[-123.36228542607955,48.42316242361115]}},
										{"type":"Feature","properties":{"Village_Ty":"Save-On-Foods Memorial Arena","Location":"Performance Space - Indoor Venue","OBJECTID_1":5},"geometry":{"type":"Point","coordinates":[-123.36062942575153,48.43157759951067]}},
										{"type":"Feature","properties":{"Village_Ty":"Art Gallery of Greater Victoria","Location":"Museums and Galleries","OBJECTID_1":6},"geometry":{"type":"Point","coordinates":[-123.34750867500918,48.42218671213247]}},
										{"type":"Feature","properties":{"Village_Ty":"Emily Carr House","Location":"Museums and Galleries","OBJECTID_1":7},"geometry":{"type":"Point","coordinates":[-123.36984195417843,48.413696336606975]}},
										{"type":"Feature","properties":{"Village_Ty":"Legacy Art Gallery","Location":"Museums and Galleries","OBJECTID_1":8},"geometry":{"type":"Point","coordinates":[-123.36529230814709,48.42663145906587]}},
										{"type":"Feature","properties":{"Village_Ty":"Point Ellice House","Location":"Museums and Galleries","OBJECTID_1":9},"geometry":{"type":"Point","coordinates":[-123.37724126889833,48.43595175940157]}},
										{"type":"Feature","properties":{"Village_Ty":"Royal BC Museum","Location":"Museums and Galleries","OBJECTID_1":10},"geometry":{"type":"Point","coordinates":[-123.36761594189196,48.41970139508483]}},
										{"type":"Feature","properties":{"Village_Ty":"Centennial Square","Location":"Performance Space - Outdoor Venue","OBJECTID_1":11},"geometry":{"type":"Point","coordinates":[-123.36555020101375,48.42886397546541]}},
										{"type":"Feature","properties":{"Village_Ty":"Cameron Bandshell","Location":"Performance Space - Outdoor Venue","OBJECTID_1":12},"geometry":{"type":"Point","coordinates":[-123.36605649828039,48.413085203760325]}},
										{"type":"Feature","properties":{"Village_Ty":"Greater Victoria Public Library","Location":"Educational and Learning Institutions","OBJECTID_1":13},"geometry":{"type":"Point","coordinates":[-123.36416978901504,48.42326477327405]}},
										{"type":"Feature","properties":{"Village_Ty":"Victoria Academy of Ballet","Location":"Educational and Learning Institutions","OBJECTID_1":14},"geometry":{"type":"Point","coordinates":[-123.36607615361136,48.42379192073151]}},
										{"type":"Feature","properties":{"Village_Ty":"Victoria College of Art","Location":"Educational and Learning Institutions","OBJECTID_1":15},"geometry":{"type":"Point","coordinates":[-123.32841246885049,48.42808366313906]}},
										{"type":"Feature","properties":{"Village_Ty":"Victoria Conservatory of Music","Location":"Educational and Learning Institutions","OBJECTID_1":16},"geometry":{"type":"Point","coordinates":[-123.35846817626006,48.42642579185861]}},
										{"type":"Feature","properties":{"Village_Ty":"Vancouver Island School of Art","Location":"Educational and Learning Institutions","OBJECTID_1":17},"geometry":{"type":"Point","coordinates":[-123.35791627176717,48.4365346604263]}},
										{"type":"Feature","properties":{"Village_Ty":null,"Location":"Educational and Learning Institutions","OBJECTID_1":18},"geometry":{"type":"Point","coordinates":[-123.37064445307537,48.42676976616772]}},
										{"type":"Feature","properties":{"Village_Ty":null,"Location":"Museums and Galleries","OBJECTID_1":19},"geometry":{"type":"Point","coordinates":[-123.34355269116062,48.42241956309773]}},
										{"type":"Feature","properties":{"Village_Ty":null,"Location":"Museums and Galleries","OBJECTID_1":20},"geometry":{"type":"Point","coordinates":[-123.36918834580543,48.4260052977446]}},
										{"type":"Feature","properties":{"Village_Ty":null,"Location":"Performance Space - Outdoor Venue","OBJECTID_1":21},"geometry":{"type":"Point","coordinates":[-123.37008668447451,48.422880013638625]}},
										{"type":"Feature","properties":{"Village_Ty":null,"Location":"Performance Space - Indoor Venue","OBJECTID_1":22},"geometry":{"type":"Point","coordinates":[-123.35906847712003,48.4315480671405]}},
										{"type":"Feature","properties":{"Village_Ty":"Blanshard Community Centre","Location":"Community Centres","OBJECTID_1":23},"geometry":{"type":"Point","coordinates":[-123.36119193168344,48.43700805283813]}},
										{"type":"Feature","properties":{"Village_Ty":"Burnside Gorge Community Centre","Location":"Community Centres","OBJECTID_1":24},"geometry":{"type":"Point","coordinates":[-123.37802613927317,48.444423902640416]}},
										{"type":"Feature","properties":{"Village_Ty":"Fairfield Community Place","Location":"Community Centres","OBJECTID_1":25},"geometry":{"type":"Point","coordinates":[-123.3477188237663,48.415149943048235]}},
										{"type":"Feature","properties":{"Village_Ty":"Fernwood Community Centre","Location":"Community Centres","OBJECTID_1":26},"geometry":{"type":"Point","coordinates":[-123.34800290823685,48.431147235142745]}},
										{"type":"Feature","properties":{"Village_Ty":"James Bay Community Centre","Location":"Community Centres","OBJECTID_1":27},"geometry":{"type":"Point","coordinates":[-123.37921155382436,48.41738640589181]}},
										{"type":"Feature","properties":{"Village_Ty":"Oaklands Community Centre","Location":"Community Centres","OBJECTID_1":28},"geometry":{"type":"Point","coordinates":[-123.33771836589398,48.44096034979199]}},
										{"type":"Feature","properties":{"Village_Ty":"Victoria West YMCA","Location":"Community Centres","OBJECTID_1":29},"geometry":{"type":"Point","coordinates":[-123.38741734822972,48.4376238424216]}}]};

var schools ={
																				"type":"FeatureCollection",
																				"crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:OGC:1.3:CRS84"}},
																				"features":[
																				{"type":"Feature","properties":{"SchoolName":"Burnside Elementary","OBJECTID":2,"Category":"SD61 Public School","Address":"3130 Jutland Rd"},"geometry":{"type":"Point","coordinates":[-123.3752716406797,48.44354568004362]}},
																				{"type":"Feature","properties":{"SchoolName":"Central Middle School","OBJECTID":3,"Category":"SD61 Public School","Address":"1280 Fort St"},"geometry":{"type":"Point","coordinates":[-123.3475417551845,48.42397913621582]}},
																				{"type":"Feature","properties":{"SchoolName":"George Jay Elementary","OBJECTID":4,"Category":"SD61 Public School","Address":"1118 Princess Ave"},"geometry":{"type":"Point","coordinates":[-123.35123813194863,48.433077990693725]}},
																				{"type":"Feature","properties":{"SchoolName":"Glenlyon-Norfolk School","OBJECTID":5,"Category":"SD61 Public School","Address":"801 Bank St"},"geometry":{"type":"Point","coordinates":[-123.33013979395265,48.4203241224749]}},
																				{"type":"Feature","properties":{"SchoolName":"James Bay Community School","OBJECTID":6,"Category":"SD61 Public School","Address":"140 Oswego St"},"geometry":{"type":"Point","coordinates":[-123.37969661814597,48.41692569915388]}},
																				{"type":"Feature","properties":{"SchoolName":"Margaret Jenkins Elementary","OBJECTID":7,"Category":"SD61 Public School","Address":"1824 Fairfield Rd"},"geometry":{"type":"Point","coordinates":[-123.32894026783582,48.41615621242072]}},
																				{"type":"Feature","properties":{"SchoolName":"Oaklands Elementary","OBJECTID":8,"Category":"SD61 Public School","Address":"2827 Belmont Ave"},"geometry":{"type":"Point","coordinates":[-123.33834878947088,48.44090730350409]}},
																				{"type":"Feature","properties":{"SchoolName":"Quadra Elementary","OBJECTID":9,"Category":"SD61 Public School","Address":"3031 Quadra St"},"geometry":{"type":"Point","coordinates":[-123.36049335336968,48.4459900264802]}},
																				{"type":"Feature","properties":{"SchoolName":"S.J. Willis School","OBJECTID":10,"Category":"Alternative Education","Address":"923 Topaz Ave"},"geometry":{"type":"Point","coordinates":[-123.36242723539803,48.44147363176645]}},
																				{"type":"Feature","properties":{"SchoolName":"Sir James Douglas Elementary","OBJECTID":11,"Category":"SD61 Public School","Address":"401 Moss St"},"geometry":{"type":"Point","coordinates":[-123.34782886957368,48.41563154626643]}},
																				{"type":"Feature","properties":{"SchoolName":"South Park School","OBJECTID":12,"Category":"SD61 Public School","Address":"508 Douglas St"},"geometry":{"type":"Point","coordinates":[-123.36638789825658,48.41768534031968]}},
																				{"type":"Feature","properties":{"SchoolName":"annex of École Victor-Brodeur","OBJECTID":15,"Category":"SD61 Public School","Address":"556 Boleskine Rd"},"geometry":{"type":"Point","coordinates":[-123.32820912485957,48.427792565010456]}},
																				{"type":"Feature","properties":{"SchoolName":"Victor School","OBJECTID":16,"Category":"SD61 Public School","Address":"2260 Victor St"},"geometry":{"type":"Point","coordinates":[-123.33771771666328,48.432185360210255]}},
																				{"type":"Feature","properties":{"SchoolName":"Victoria High School","OBJECTID":17,"Category":"SD61 Public School","Address":"1260 Grant St"},"geometry":{"type":"Point","coordinates":[-123.34731207066802,48.42962032552843]}},
																				{"type":"Feature","properties":{"SchoolName":"Victoria West Elementary","OBJECTID":18,"Category":"SD61 Public School","Address":"750 Front St"},"geometry":{"type":"Point","coordinates":[-123.38911111939049,48.43394057558446]}},
																				{"type":"Feature","properties":{"SchoolName":"Christ Church Cathedral School","OBJECTID":19,"Category":"Independent School","Address":"912 Vancouver St"},"geometry":{"type":"Point","coordinates":[-123.35774295727407,48.42217518288158]}},
																				{"type":"Feature","properties":{"SchoolName":"Elizabeth Buckley School","OBJECTID":20,"Category":"Independent School","Address":"1309 Hillside Ave"},"geometry":{"type":"Point","coordinates":[-123.35010731306049,48.439680454901826]}},
																				{"type":"Feature","properties":{"SchoolName":"Oak & Orca School","OBJECTID":21,"Category":"Independent School","Address":"2738 Higgins St"},"geometry":{"type":"Point","coordinates":[-123.34981667102214,48.44180567122359]}},
																				{"type":"Feature","properties":{"SchoolName":"Pacific School of Innovation and Inquiry","OBJECTID":22,"Category":"Independent School","Address":"100-808 Douglas St"},"geometry":{"type":"Point","coordinates":[-123.36620977978588,48.42255754448799]}},
																				{"type":"Feature","properties":{"SchoolName":"Selkirk Montessori School","OBJECTID":23,"Category":"Independent School","Address":"2970 Jutland Rd"},"geometry":{"type":"Point","coordinates":[-123.37840763326929,48.44079145055804]}},
																				{"type":"Feature","properties":{"SchoolName":"St. Patrick's School","OBJECTID":24,"Category":"Independent School","Address":"2368 Trent St"},"geometry":{"type":"Point","coordinates":[-123.3242377068303,48.43365841154717]}},
																				{"type":"Feature","properties":{"SchoolName":"Victoria School for Ideal Education","OBJECTID":25,"Category":"Independent School","Address":"2820 Belmont Ave"},"geometry":{"type":"Point","coordinates":[-123.33931570343562,48.440393993563575]}},
																				{"type":"Feature","properties":{"SchoolName":"Cloverdale Traditional Elementary","OBJECTID":26,"Category":"SD61 Public School","Address":"2780 Richmond Rd"},"geometry":{"type":"Point","coordinates":[-123.32850844074947,48.44002275843326]}},
																				{"type":"Feature","properties":{"SchoolName":"Continuing Ed SD 61","OBJECTID":27,"Category":"Continuing Education","Address":"923 Topaz Ave 2nd Floor"},"geometry":{"type":"Point","coordinates":[-123.36242723539803,48.44147363176645]}},
																				{"type":"Feature","properties":{"SchoolName":"École Quadra Elementary","OBJECTID":28,"Category":"SD61 Public School","Address":"3031 Quadra St"},"geometry":{"type":"Point","coordinates":[-123.36049335336968,48.4459900264802]}},
																				{"type":"Feature","properties":{"SchoolName":"Lansdowne Middle School","OBJECTID":29,"Category":"SD61 Public School","Address":"1765 Lansdowne Rd"},"geometry":{"type":"Point","coordinates":[-123.32785124908574,48.445523990377566]}}]};

var facilitiesMakerOptions = {
	radius:10,
	fillColor:"	#DF0E62",
	color:"	#DF0E62",
	weight:1,
	opacity:0.5,
	fillOpacity:0.5
};

var schoolsMakerOptions = {
	radius:10,
	fillColor:"#FAC70B",
	color:"	#FAC70B",
	weight:1,
	opacity:0.5,
	fillOpacity:0.5
};

function onEachFacility(feature, layer){
	if(feature.properties.Village_Ty){
		layer.bindTooltip(feature.properties.Village_Ty);
	}
}

function onEachSchool(feature, layer){
	if(feature.properties.SchoolName){
		layer.bindTooltip(feature.properties.SchoolName);
	}
}

var buffered = turf.buffer(schools, 1, {units:'kilometers'});
L.geoJson(buffered).addTo (map);

L.geoJson(facilities,{
	pointToLayer:function(feature,latlng){
		return L.circleMarker(latlng,facilitiesMakerOptions);
	},
	onEachFeature:onEachFacility
}).addTo(map);

L.geoJson(schools,{
	pointToLayer:function(feature,latlng){
		return L.circleMarker(latlng,schoolsMakerOptions);
	},
	onEachFeature:onEachSchool
}).addTo(map);



	</script>

</body>
</html>
